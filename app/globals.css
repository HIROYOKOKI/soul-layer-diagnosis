@import "tailwindcss";

/* =========================
   Base（配色・タイポ・モバイル最適化）
   ========================= */
@layer base {
  :root {
    color-scheme: dark;

    /* テーマ変数（青＝未来モードをデフォルト） */
    --bg: #000000;
    --fg: #ffffff;
    --panel: rgba(255,255,255,0.05);
    --border: rgba(255,255,255,0.10);

    --accent: #4fc3ff; /* 未来モード(青) */
    --accent-shadow: 0 0 10px #4fc3ff, 0 0 20px #4fc3ff;
    --accent-shadow-strong: 0 0 20px #4fc3ff, 0 0 40px #4fc3ff;

    /* テーマ用 RGB（波紋/フォーカスで使用） */
    --accent-rgb: 79,195,255; /* #4fc3ff */

    /* ── EVΛƎ 構造別カラー（RGB）── */
    --accent-e-rgb: 255,95,95;     /* E：衝動=レッド */
    --accent-v-rgb: 79,195,255;    /* V：夢=シアン/ブルー */
    --accent-l-rgb: 255,209,102;   /* Λ：選択=アンバー/ゴールド */
    --accent-eps-rgb: 192,132,252; /* Ǝ：観測=バイオレット */
  }

  /* 情熱モード(ピンク) */
  :root[data-mode="pink"] {
    --accent: #ff4fdf;
    --accent-shadow: 0 0 10px #ff4fdf, 0 0 20px #ff4fdf;
    --accent-shadow-strong: 0 0 20px #ff4fdf, 0 0 40px #ff4fdf;
    --accent-rgb: 255,79,223; /* #ff4fdf */
  }

  html { 
    -webkit-text-size-adjust: 100%;
    scroll-behavior: smooth;
    height: 100%;
  }
  body { 
    height: 100%;
    background: var(--bg);
    color: var(--fg);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  a { 
    color: inherit; 
    text-decoration: none; 
    -webkit-tap-highlight-color: transparent;
  }
  button, input, textarea, select {
    -webkit-appearance: none;
    appearance: none;
    background: none;
    border-radius: 0;
    color: inherit;
    font: inherit;
  }
  * { -webkit-touch-callout: none; }
  input:-webkit-autofill,
  input:-webkit-autofill:hover,
  input:-webkit-autofill:focus,
  textarea:-webkit-autofill,
  select:-webkit-autofill {
    -webkit-text-fill-color: #fff;
    -webkit-box-shadow: 0 0 0px 1000px #0a0a0a inset;
    transition: background-color 9999s ease-in-out 0s;
  }
  ::-webkit-scrollbar { width:10px; height:10px; }
  ::-webkit-scrollbar-thumb { background: rgba(255,255,255,.12); border-radius:9999px; }
  ::-webkit-scrollbar-track { background: rgba(255,255,255,.04); }

  /* キーボード操作の視認性向上（テーマRGB準拠） */
  :focus-visible {
    outline: 2px solid rgb(var(--accent-rgb));
    outline-offset: 2px;
  }
}

/* =========================
   Components（フォーム・ボタン）
   ========================= */
/* ==== 波紋ベース：明るく、押した瞬間だけ強く光る ==== */
@layer components {
  .ripple {
    position: absolute;
    border-radius: 9999px;
    pointer-events: none;
    width: 24px;
    height: 24px;
    transform: translate(-50%, -50%) scale(0);
    animation: ripple-bright 650ms ease-out forwards;
    mix-blend-mode: color-dodge;          /* 明るさを加算的に */
    filter: drop-shadow(0 0 12px rgba(255,255,255,.35));
  }

  /* テーマ色 */
  .ripple-accent {
    background: radial-gradient(closest-side,
      rgba(var(--accent-rgb), 0.85),
      rgba(var(--accent-rgb), 0.45) 40%,
      rgba(var(--accent-rgb), 0.12) 70%,
      transparent 100%);
  }
  /* 構造別色（E/V/Λ/Ǝ） */
  .ripple-e   { background: radial-gradient(closest-side, rgba(var(--accent-e-rgb), 0.85),   rgba(var(--accent-e-rgb), 0.45) 40%,   rgba(var(--accent-e-rgb), 0.12) 70%,   transparent); }
  .ripple-v   { background: radial-gradient(closest-side, rgba(var(--accent-v-rgb), 0.85),   rgba(var(--accent-v-rgb), 0.45) 40%,   rgba(var(--accent-v-rgb), 0.12) 70%,   transparent); }
  .ripple-l   { background: radial-gradient(closest-side, rgba(var(--accent-l-rgb), 0.85),   rgba(var(--accent-l-rgb), 0.45) 40%,   rgba(var(--accent-l-rgb), 0.12) 70%,   transparent); }
  .ripple-eps { background: radial-gradient(closest-side, rgba(var(--accent-eps-rgb), 0.85), rgba(var(--accent-eps-rgb), 0.45) 40%, rgba(var(--accent-eps-rgb), 0.12) 70%, transparent); }

  /* 押下中の軽い縮小（プリ効果はこれだけ・色は変えない） */
  .btn-pressable { transition: transform 120ms ease; }
  .btn-pressable:active { transform: scale(.985); }

  /* 事前の外周グローは完全OFF（プリエフェクト削除） */
}

/* ==== 押している間だけ外周が光る（構造別） ==== */
@layer components {
  .btn-ripple[data-structure="E"]:active  { box-shadow: 0 0 30px rgba(var(--accent-e-rgb), .55); }
  .btn-ripple[data-structure="V"]:active  { box-shadow: 0 0 30px rgba(var(--accent-v-rgb), .55); }
  .btn-ripple[data-structure="Λ"]:active  { box-shadow: 0 0 30px rgba(var(--accent-l-rgb), .55); }
  .btn-ripple[data-structure="Ǝ"]:active  { box-shadow: 0 0 30px rgba(var(--accent-eps-rgb), .55); }
}

/* ==== 波紋アニメ（拡大率UP & 少し長め） ==== */
@keyframes ripple-bright {
  0%   { transform: translate(-50%, -50%) scale(0);   opacity: .95; }
  70%  { transform: translate(-50%, -50%) scale(5.2); opacity: .25; }
  100% { transform: translate(-50%, -50%) scale(6.2); opacity: 0;   }
}

/* =========================
   Utilities（小道具）
   ========================= */
@layer utilities {
  .no-underline { text-decoration: none !important; }
  .no-tap-highlight { -webkit-tap-highlight-color: transparent; }
  .touch-manipulation { touch-action: manipulation; }
}

/* =========================
   Animations（波紋・プリファレンス配慮）
   ========================= */
@keyframes ripple {
  0%   { transform: translate(-50%, -50%) scale(0);   opacity: 0.7; }
  80%  { transform: translate(-50%, -50%) scale(4);   opacity: 0.15; }
  100% { transform: translate(-50%, -50%) scale(5.2); opacity: 0; }
}

/* 動きを最小化設定のユーザーには穏やかに */
@media (prefers-reduced-motion: reduce) {
  .btn-pressable,
  .ripple,
  .ripple-gradient {
    transition: none !important;
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
  }
}
